<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Send whatsapp Demo</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/sha256.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/hmac.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/enc-base64.min.js"></script>
</head>
<body>
<script>



window.addEventListener("load", function () {
	function hmacBase64(string, secret) {
		var signature2 = CryptoJS.HmacSHA256(string, secret);
		return(signature2.toString(CryptoJS.enc.Base64));
		}
  function sendData() {
	  
    var XHR = new XMLHttpRequest();

    // Bind the FormData object and the form element
    var FD = new FormData(form);

    // Define what happens on successful data submission
    XHR.addEventListener("load", function(event) {
      alert(event.target.responseText);
    });

    // Define what happens in case of error
    XHR.addEventListener("error", function(event) {
      alert('Oups! Something goes wrong.');
    });

    // Set up our request
    var url = "http://localhost:8080/MyWhatsAppSeleniumProj/WhatsApp?nb=" + form.elements["nb"].value + "&msg=" + form.elements["msg"].value;
    var secret = "12345678";
    XHR.open("POST", url);
    
    //Set autentication
    
    var hmac = hmacBase64(url,secret);
    XHR.setRequestHeader("Authorization", hmac);

    // The data sent is what the user provided in the form
    XHR.send(form);
  }
 
  // Access the form element...
  var form = document.getElementById("myForm");

  // ...and take over its submit event.
  form.addEventListener("submit", function (event) {
    event.preventDefault();

    sendData();
  });
});
</script>

<form id="myForm">
  <label for="nb">Destination Number (international form):</label>
  <input id=nb name="nb" value="34644016790">
  <label for="mesg">Message:</label>
  <input id=msg name="msg" value="Test">
  <input type="submit" value="Send Me!">
</form>
</body>
</html>